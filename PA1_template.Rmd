---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

Change the path of the figures and set warnings to false
```{r global_options}
knitr::opts_chunk$set(fig.path='figure/', warning=FALSE, message=FALSE)
```

## Loading and preprocessing the data

Read the CSV data directly from the activity.zip file
```{r}
data <- read.csv(unz("activity.zip", "activity.csv"))
```

Convert the date column to POSIXct
```{r}
data$date <- as.POSIXct(data$date)
```

Perform a basic inspection of the data
```{r}
head(data)
```


## What is mean total number of steps taken per day?

Load the required libraries
```{r}
library(plyr)
library(ggplot2)
```

Generate an aggregate of the steps by day
```{r}
steps_by_day <- aggregate(data$steps, by = list(data$date), sum, na.rm=TRUE) 
```

Rename the column headers into something human readable
```{r}
names(steps_by_day) <- c("date","steps")
```

Create and display the plot
```{r}
steps_by_day_plot <- ggplot(steps_by_day,aes(x = steps)) +
       ggtitle("Steps by day") +
       xlab("steps") + ylab("count") +
       geom_histogram(binwidth = 200)
steps_by_day_plot
```

Calculate the mean and the median
```{r}
options(scipen=0, digits=2)
mean_steps_by_day   <- mean(steps_by_day$steps , na.rm = TRUE)
median_steps_by_day <- median(steps_by_day$steps , na.rm = TRUE)
```
The mean steps by day is `r mean_steps_by_day` whilst the median steps by day is `r median_steps_by_day`

## What is the average daily activity pattern?


Generate a dataset containing the means steps per interval and rename the output columns
```{r}
mean_interval_steps <- aggregate(data$steps, by = list(data$interval), mean, na.rm=TRUE)
names(mean_interval_steps) <- c("interval","steps")
```

Determine the 5 minute interval with the most steps and determine the max steps
```{r}
max_steps                <- max(mean_interval_steps$steps);
interval_with_most_steps <- mean_interval_steps[which.max(mean_interval_steps$steps),c("interval")]
```

Plot the output
```{r}
mean_interval_steps_plot <- ggplot(mean_interval_steps,aes(interval,steps)) + 
                            geom_line() + 
                            annotate("text", x = interval_with_most_steps, y= max_steps, label = "Interval with most steps")
mean_interval_steps_plot 
```

The 5 minute interval with the most steps is `r interval_with_most_steps`

## Imputing missing values

Calculate the number of missing values
```{r}
sum_missing_values <- sum(is.na(data$steps))
```
The number of missing values is `r sum_missing_values`

```{r}

```

Install zoo in order to help us deal with missing values
```{r}
library(zoo)
```

```{r}
interpolated_data <- read.zoo(data, index = 2, aggregate = FALSE)
head(interpolated_data)
#aggregate(zoo_data$steps, by = list(zoo_data$interval), mean) 
#zoo_mean_interval_steps <- aggregate(zoo_steps, by = list(data$interval), mean, na.rm=TRUE)
```

## Are there differences in activity patterns between weekdays and weekends?
